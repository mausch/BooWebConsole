<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
		<title>Boo console</title>
		<style type="text/css">
		.error {
		    color: red;
		}
		</style>
		<link rel="Stylesheet" href="static.ashx?r=jquery.autocomplete.css" type="text/css" />
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"></script>
		<script src="static.ashx?r=jquery.autocomplete.js" type="text/javascript"></script>
	</head>
	<body>
	    <form method="post" action="">
	        <textarea name="prg" cols="80" rows="10" accesskey="e" id="prg">#if ($model.Prg)$model.Prg#end</textarea><br />
	        <input type="submit" value="Execute" accesskey="x" />
	    </form>
	    #if ($model.Errors)
	    <pre class="error">$model.Errors</pre>
	    #end
	    #if ($model.Output)
	    <pre>$model.Output</pre>
	    #end
	    <script type="text/javascript">
	    		function getPosition(textarea) {
	    				var a = document.getElementById(textarea);
							a.focus();
							return a.selectionStart;
	    		}
	    		
	    		function insertString(a, pos, b) {
	    			return a.substr(0, pos) + b + a.substr(pos);
	    		}
	    		
	        jQuery('#prg').autocomplete('suggest.ashx', {
	            matchCase: true,
	            dataType: 'json',
	            beforeSend: function(r) {
	            	var pos = getPosition('prg');
	            	return insertString(r, pos, '__codecomplete__');
	            },
	            formatItem: function(r) { return r; },
	            parse: function(data) {
	            		var v = jQuery('#prg').val();
	                return jQuery.map(data, function(r) {
	                    return {
	                        data: r,
	                        value: v + r,
	                        result: v + r
	                    };
	                });
	            }
	        });
	    </script>
	</body>
</html>